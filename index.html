<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<!-- Firebase SDK (compat 版，最簡單接) -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js"></script>


<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="icon" type="image/png" sizes="32x32" href="reminder.png">
<link rel="apple-touch-icon" sizes="180x180" href="reminder.png">
<link rel="manifest" href="manifest.json">

  <title>MyTask</title>
  <style>

/* 日期輸入欄位：固定高度，iOS/Android/桌機一致 */
input[type="date"] {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  font-size: 1rem;
  -webkit-appearance: none;
  flex: 1;
  min-width: 0;
  
  /* 固定高度，避免有無日期時跳動 */
  height: 38px;       /* 你可以依現有表單高度調整，例如 36px 或 40px */
  line-height: 38px;  /* 跟 height 一樣，確保文字垂直置中 */
}
/* 全域輸入元件字體大小 */
input, select, textarea, option {
  font-size: 16px;     /* 推薦手機安全字體大小，避免 iOS 自動放大 */
  line-height: 1.4;    /* 行高稍微加高一點，閱讀更舒服 */
}
button {
  font-size: 15px;
}

    :root {
      --blue-light: #ebf5fc;
      --green-light: #e6f9f0;
      --yellow-light: #fffbe6;
      --white: #ffffff;
      --gray-text: #444;
      --urgent-color: #ffeaea;
  --app-bg: var(--blue-light);
    }
    * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
    body {
  margin: 0; padding: 1rem; background-color: var(--app-bg);
  color: var(--gray-text); display: flex; justify-content: center;
}
    .container { width: 100%; max-width: 480px; position: relative; }
h1 {
  display: inline-flex;  /* 原本是 flex */
  align-items: center;
  justify-content: center;
  gap: 10px;
  font-size: 24px;
  margin: 6px 0 10px;
  padding: 4px 10px;
  border-radius: 8px;
  transition: background-color .2s, box-shadow .2s;
}

h1:hover {
  background: rgba(0,0,0,.05);
  box-shadow: 0 0 0 2px rgba(0,0,0,.08) inset;
}
    .section {
      background-color: #ffffff; border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
      padding: 1rem; margin-bottom: 1rem;
    }
    .section-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 0.5rem; }
    .task {
      display: flex; justify-content: space-between; align-items: center;
      background-color: var(--yellow-light); padding: 0.75rem 1rem;
      border-radius: 8px; margin-bottom: 0.5rem; cursor: pointer;
    }
    .task-content { flex: 1; }
    .task-title { font-size: 1.2rem;font-weight: 600; margin-bottom: 0.25rem; }
    .task-due { font-size: 0.85rem; color: #888; }
    .task-days {
      background-color: var(--yellow-light); color: brown;
      border-radius: 50%; padding: 0.4rem 0.6rem; font-size: 0.85rem;
      font-weight: bold; flex-shrink: 0; text-align: center; margin-left: 1rem;
    }
    .fab {
      position: fixed; bottom: 24px; right: 24px; width: 40px; height: 40px;
      background-color: #00aaff; color: white; border-radius: 50%; font-size: 32px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); z-index: 10;
    }
    .menu {
      position: fixed; bottom: 90px; right: 24px; background-color: white;
      border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      display: none; flex-direction: column; z-index: 9;
    }
    .menu button {
      border: none; background: none; padding: 12px 16px;
      font-size: 14px; text-align: left; cursor: pointer;
    }

    .modal {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background-color: rgba(0, 0, 0, 0.3); display: none;
      justify-content: center; align-items: center; z-index: 20;
    }
    .modal-content {
      background-color: white; padding: 1rem; border-radius: 12px;
      width: 90%; max-width: 400px; position: relative;
    }
    .modal-content label { display: block; margin-top: 0.5rem; font-size: 0.9rem; }
/* 只給輸入框/下拉/文字區，排除 radio & checkbox */
.modal-content input:not([type="radio"]):not([type="checkbox"]),
.modal-content select,
.modal-content textarea {
  width: 100%;
  padding: 0.5rem;
  margin-top: 0.25rem;
  border: 1px solid #ccc;
  border-radius: 6px;
}

//儲存按鈕
.save-btn {
  background-color: #009973;
  color: white;
  border: none;
  padding: 0.5rem;
  border-radius: 6px;
  cursor: pointer;
  margin-bottom: 0.5rem;
  width: 100%;
}
.save-btn:hover {
  background-color: #008060;
}

.modal-content > button {
  margin-top: 1rem;
  width: 100%;
  padding: 0.5rem;
  background-color: #00aaff;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}


.save-btn-half, .delete-btn-half {
  flex: 1;
  padding: 0.5rem;
  border-radius: 6px;
  cursor: pointer;
  width: 50%;
  border: none;
}

.save-btn-half {
  background-color: #77d4bc;
  color: white;
}
.save-btn-half:hover {
  background-color: #008060;
}

.delete-btn-half {
  background-color: #fc9a9a;
  color: white;
}
.delete-btn-half:hover {
  background-color: #cc3333;
}

.close-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 28px;
  height: 28px;
  padding: 0;
  margin: 0;
  border: none;
  border-radius: 50%;
  background-color: #eee;
  color: #333;
  font-size: 16px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.modal-content > .close-btn {
  width: auto;
}

#check-success {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 9999;
  width: 100px;
  height: 100px;
  opacity: 0;
  pointer-events: none;
}

#check-success.show {
  animation: pop-in 1.5s ease forwards;
}

#check-success svg {
  width: 100px;
  height: 100px;
}

.circle {
  stroke: #a2f4c5;
  stroke-width: 4;
  stroke-dasharray: 157;
  stroke-dashoffset: 157;
  animation: draw-circle 0.5s ease-out forwards;
}

.check {
  stroke: #2ecc71;
  stroke-width: 5;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-dasharray: 30;
  stroke-dashoffset: 30;
  animation: draw-check 0.3s 0.5s ease-out forwards;
}

@keyframes draw-circle {
  to {
    stroke-dashoffset: 0;
  }
}

@keyframes draw-check {
  to {
    stroke-dashoffset: 0;
  }
}

@keyframes pop-in {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.5);
    filter: blur(4px);
  }
  40% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.1);
    filter: blur(0);
  }
  80% {
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
}
.confirm-buttons {
  display: flex;
  gap: 0.75rem;
  margin-top: 1.5rem;
}

.confirm-buttons button {
  flex: 1;
  padding: 0.6rem;
  font-size: 1rem;
  font-weight: bold;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.confirm-btn {
  background-color: #fc9a9a;
  color: white;
}
.confirm-btn:hover {
  background-color: #cc4444;
}

.cancel-btn {
  background-color: #f0f0f0;
  color: #333;
}
.cancel-btn:hover {
  background-color: #ddd;
}

//編輯分類用
.section.edit-mode {
  position: relative;
  padding-left: 2.5rem;
}

.section-title {
  position: relative; /* 新增這一行讓內部絕對定位生效 */
  font-size: 1.2rem;
  font-weight: bold;
  margin-bottom: 0.5rem;
}

.drag-handle {
  display: inline-block;
  margin-right: 0.5rem;
  font-size: 1.2rem;
  cursor: grab;
  color: #888;
  vertical-align: middle;
}


.delete-btn {
  position: absolute;
  top: 0;
  right: 0;
  background-color: transparent;
  border: none;
  font-size: 1rem;
  color: #999;
  cursor: pointer;
  display: none;
}
.section.edit-mode .delete-btn {
  display: block;
}

.section.dragging {
  opacity: 0.5;
  background-color: transparent !important;
}

.dragging {
  opacity: 0.6;
  background: #eef8ff;
}


/* 重命名按鈕 */
/* 讓標題成一行排列：☰、標題文字、✎（刪除鍵依然在右上角絕對定位） */
.section-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

/* 鉛筆跟在標題文字後方（不要絕對定位） */
.rename-btn {
  position: static;           /* 重要：取消原本的 absolute */
  display: none;              /* 只有編輯模式才顯示 */
  background: transparent;
  border: none;
  font-size: 1rem;
  color: #999;
  cursor: pointer;
  margin-left: 0.8rem;
transform: translateY(-2.2px); /* ⬆ 往上 2px，可自行調整 */
  padding: 0;                 /* 取消小方塊外框感 */
}
.section.edit-mode .rename-btn { display: inline-flex; }

/* 更多功能（修正後）*/
/* 右上角 ... 按鈕 */
.more-btn {
  position: fixed;
  top: 12px;
  left: 12px;
  width: 32px;      /* 縮小寬 */
  height: 32px;     /* 縮小高 */
  border-radius: 50%;
  background: #fff;
  color: #555;
  font-size: 18px;  /* 字體也縮小 */
  font-weight: bold;
  display: flex;
  align-items: center;    /* 垂直置中 */
  justify-content: center;/* 水平置中 */
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  cursor: pointer;
  z-index: 100;
  line-height: 1;         /* 確保文字垂直居中 */
}



/* 更多功能 Modal */
#moreModal .modal-content {
  max-width: 300px;
}
.filter-days {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: -1rem;
}
.filter-days label {
  display: flex;
  align-items: center;
  gap: 0.3rem;
  font-size: 0.9rem;
}

/* 歷史紀錄 */
.filter-status {
  display: flex;
  gap: 1rem;    
  margin-top: -1rem;           /* 兩個選項之間的距離 */
}

.filter-status label {
  display: inline-flex;    /* 關鍵：讓○和文字在同一行 */
  align-items: center;
  gap: 0.25rem;            /* ○ 和文字距離 */
  white-space: nowrap;     /* 禁止文字換行 */
}

/* 天數設定 */
.filter-mode {
  display: flex;
  gap: 1rem;          /* 選項之間距離 */
  margin-top: -1rem;  /* 跟上方標題的距離可依需求調整 */
}

.filter-mode label {
  display: inline-flex;     /* ○ 和文字同一行 */
  align-items: center;
  gap: 0.25rem;             /* ○ 和文字距離 */
  white-space: nowrap;      /* 禁止換行 */
}

.logout-btn{
  width:100%;
font-size:15px;
  padding:0.6rem;
  background:#f5f5f5;
  color:#333;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.logout-btn:hover{ background:#eee; }

/* 統一把所有 modal 蓋在頁面上 */
.modal { z-index: 200; }

/* ⋯ 選單的層級稍低一點 */
#moreModal { z-index: 180; }

/* 登出確認再高一點，確保永遠在最上面 */
#logoutModal { z-index: 220; }

/* 登入CSS */
#loginPage{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  background:var(--blue-light);
}

/* 白色卡片：這裡控制寬度、圓角、陰影、內距 */
#loginCard{
  position: absolute !important; /* 無視前面設定 */
  top: 80px;                      /* 往上 20px，你可以改 */
  left: 50%;
  transform: translateX(-50%);    /* 水平置中 */
  background:var(--white);
  border-radius:12px;          /* ← 卡片圓角 */
  box-shadow:0 2px 6px rgba(0,0,0,0.08); /* ← 卡片陰影 */
  padding:2rem;                /* ← 卡片內距 */
  width:95%;
  max-width:450px;
min-height: 500px; /* 最小高度，內容超過時會自動變高 */

}

/* 標題 */
.login-title{
  text-align:center;
  margin:0 0 1.5rem;
  font-size:28px;              /* ← 標題大小 */
  font-weight:800;
}

/* label 與欄位的間距 */
.login-label{
  font-weight:600;
  margin:0.4rem 0 0.4rem;
}

/* 輸入框外觀：高度、字體、圓角、邊框 */
.login-input{
  width:100%;
  height:44px;                 /* ← 欄位高度 */
  padding:0 12px;              /* ← 文字左右內距 */
  border:1px solid #ccc;
  border-radius:8px;           /* ← 欄位圓角 */
  font-size:16px;              /* ← 欄位字體大小 */
  margin:0 0 1rem;
margin-top:0.8rem;
  outline:none;
}
.login-input:focus{
  border-color:#95d3ff;
  box-shadow:0 0 0 3px rgba(0,170,255,.15);
}

/* 勾選列（checkbox 與文字在同一行） */
.login-checkrow{
  display:flex;
  align-items:center;
  gap:.4rem;
  margin:0 0 1rem;
}

/* 登入按鈕外觀與互動 */
.login-btn{
  width:100%;
  height:46px;                 /* ← 按鈕高度 */
  background:#00aaff;          /* ← 按鈕主色 */
  color:#fff;
  border:none;
  border-radius:8px;           /* ← 按鈕圓角 */
  font-size:16px;
  cursor:pointer;
}
.login-btn:hover{ background:#0791e6; }
.login-btn:active{ transform:translateY(1px); }

/* 底下紅色提示 */
.login-tip{
  margin-top:1rem;
  color:#cc4444;
  font-size:0.85rem;           /* ← 提示文字大小 */
  text-align:center;
}

/* 可選：小螢幕再縮一點 padding */
@media (max-width:360px){
  #loginCard{ padding:1.25rem; }
}

/* 區塊分類 + 重要 勾選 同行排版 */
.inline-row {
  display: flex;
  align-items: center;
  gap: .75rem;
  margin-top: .25rem;     /* 與上方 label 的距離 */
}

/* 下拉選單縮到一半寬、靠左 */
.inline-row .half {
  width: 50%;
  min-width: 160px;       /* 視需要可調或拿掉 */
}

/* 勾選的外觀 */
.important-flag {
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  white-space: nowrap;
  font-size: 0.95rem;
}
.drag-handle{
  cursor: grab;
  touch-action: none;          /* 重點：阻止預設捲動 */
  -webkit-user-select: none;   /* iOS 不要選字 */
  user-select: none;
  -webkit-user-drag: none;
}
/* 可選：內容區仍可上下捲動 */
.section { touch-action: pan-y; }


/* 滑動完成（藍色基底） */
.slide-complete {
  margin-top: .75rem;
}

.slide-track {
  position: relative;
  height: 44px;
  border-radius: 999px;
  background: linear-gradient(0deg, #e8f4ff, #f4faff);
  border: 1px solid #d6eaff;
  overflow: hidden;
  box-shadow: inset 0 1px 2px rgba(0,0,0,.05);
  -webkit-user-select: none;
  user-select: none;
  touch-action: none;
}

.slide-fill {
  position: absolute;
  inset: 0 auto 0 0;
  width: 0%;
  background: linear-gradient(90deg, #77c7ff, #00aaff);
  opacity: .25;
  transition: width .25s ease;
  pointer-events: none;
}

.slide-hint {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #449ad6;
  font-weight: 600;
  letter-spacing: .5px;
  pointer-events: none;
}

.slide-handle {
  position: absolute;
  top: 3px;
  left: 3px;
  width: 38px;
  height: 38px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ffffff, #e6f3ff);
  border: 1px solid #cfe6ff;
  box-shadow: 0 2px 6px rgba(0,0,0,.15);
  cursor: grab;
  transition: transform .2s ease;
}
.slide-handle:active { cursor: grabbing; }

.slide-track.done .slide-hint {
  color: #2f9e44;
}
.slide-track.done .slide-fill {
  background: linear-gradient(90deg, #7ee8b5, #2ecc71);
  opacity: .35;
}

/* 只在編輯狀態顯示滑桿；完成檢視(readonly)隱藏 */
#detailModal.readonly .slide-complete { display: none; }

/* 淺色版：儲存 & 移除 */
.save-btn-half,
.delete-btn-half {
  border: 1px solid transparent;
  font-weight: 600;
  box-shadow: 0 1px 2px rgba(0,0,0,.06);
  transition: background-color .15s ease, box-shadow .15s ease, transform .02s ease;
}

/* 儲存：薄薄綠藍 */
.save-btn-half {
  background: linear-gradient(0deg, #eefbf6, #f6fdf9);
  border-color: #ccefe2;
  color: #176d59;           /* 深一點，易讀 */
}
.save-btn-half:hover {
  background: #e8faf3;
  box-shadow: 0 2px 6px rgba(0,0,0,.08);
}
.save-btn-half:active { transform: translateY(1px); }

/* 移除：薄薄珊瑚粉 */
.delete-btn-half {
  background: linear-gradient(0deg, #fff3f3, #fff7f7);
  border-color: #ffd8d8;
  color: #b23b3b;           /* 深一點，易讀 */
}
.delete-btn-half:hover {
  background: #ffeef0;
  box-shadow: 0 2px 6px rgba(0,0,0,.08);
}
.delete-btn-half:active { transform: translateY(1px); }

/* 全幅儲存（若你也想同步變淺） */
.save-btn {
  background: linear-gradient(0deg, #eefbf6, #f6fdf9);
  border: 1px solid #ccefe2;
  color: #176d59;
}
.save-btn:hover { background:#e8faf3; }

/* FAB：開合時旋轉、陰影更柔和 */
.fab{
  position: fixed; bottom: 24px; right: 24px;
  width: 48px; height: 48px; border-radius: 50%;
  display:flex; align-items:center; justify-content:center;
  background:#00aaff; color:#fff; font-size:28px; font-weight:700;
  box-shadow: 0 10px 22px rgba(0,0,0,.18);
  cursor:pointer; z-index: 110;
  transition: transform .2s ease, box-shadow .2s ease, opacity .2s ease;
}
.fab:active{ transform: scale(.98); }
.fab.open{ transform: rotate(45deg); }   /* 打開時變成 × 的感覺 */

/* 新：極簡玻璃卡片浮層 */
.menu{
  position: fixed; bottom: 88px; right: 24px;
  min-width: 100px;
  padding: 8px;
  border-radius: 14px;
  background: rgba(255,255,255,.72);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(180, 210, 255, .35);
  box-shadow: 0 12px 28px rgba(0, 60, 130, .12);
  display: block;               /* 用透明控制顯示 */
  opacity: 0; transform: translateY(8px) scale(.98);
  pointer-events: none;
  z-index: 105;
}

/* 打開狀態 */
.menu.show{
  opacity: 1; transform: translateY(0) scale(1);
  pointer-events: auto;
  transition: opacity .18s ease, transform .18s ease;
}

/* 小圓角分隔 + 品牌色系按鈕 */
.menu button{
  display:flex; align-items:center; gap:.5rem;
  width:100%;
  background: transparent;
  border: 0;
  padding: 10px 12px;
  border-radius: 10px;
  font-size: 15px; font-weight: 600;
  color: #176dff;                 /* 淺藍系主色，與主視覺協調 */
  letter-spacing:.2px;
  cursor:pointer;
}

/* hover / active 的輕微回饋（手機也好點） */
.menu button:hover{
  background: linear-gradient(0deg,#eef6ff,#f7fbff);
}
.menu button:active{
  transform: translateY(1px);
}

/* 項目之間加一點間距 */
.menu button + button{ margin-top: 4px; }

/* 指向 FAB 的小尾巴 */
.menu::after{
  content:"";
  position:absolute;
  right: 12px; bottom: -6px;
  width: 12px; height:12px;
  background: rgba(255,255,255,.72);
  border: 1px solid rgba(180,210,255,.35);
  border-top: none; border-left: none;
  transform: rotate(45deg);
  box-shadow: 4px 4px 10px rgba(0,60,130,.06);
}

/* 在「已完成」時禁用（你前面已做 pointer-events/opactiy，也可沿用） */
.fab[aria-disabled="true"]{
  pointer-events: none; opacity:.5; box-shadow: none;
}
/* 預設都不顯示，避免閃爍 */
#loginPage { display: none; }
.container { display: none !important; }

/* 只在確定要顯示時，才打開對應區塊 */
html.show-login #loginPage { display: flex; }      /* 顯示登入頁 */
html.show-app   .container { display: block !important; } /* 顯示主畫面 */

/* ===== 自動登入載入層 ===== */
#autologin-overlay{
  position: fixed; inset: 0;
  display: none;                  /* 預設不顯示 */
  align-items: center;
  justify-content: center;
  background: rgba(255,255,255,.72);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  z-index: 260;                   /* 高於 modal(200) 但不擋你登出確認(220) 的話可調高到 260 */
}
#autologin-overlay.show{ display:flex; }

.autologin-box{
  display:flex; flex-direction:column; align-items:center; gap:.75rem;
  padding: 16px 18px;
  border-radius: 14px;
  background: rgba(255,255,255,.9);
  border: 1px solid rgba(180,210,255,.35);
  box-shadow: 0 12px 28px rgba(0,60,130,.12);
  transform: translateY(6px);
  animation: al-pop .2s ease-out forwards;
}

.autologin-loader{
  width: 42px; height: 42px; border-radius: 50%;
  border: 3px solid #e6f4ff;
  border-top-color: #00aaff;     /* 跟主色一致 */
  animation: al-spin .8s linear infinite;
  box-shadow: inset 0 1px 2px rgba(0,0,0,.04);
}

.autologin-text{
  font-weight: 700;
  letter-spacing: .3px;
  color: #176dff;                 /* 淺藍系字色 */
  font-size: 14px;
}

@keyframes al-spin { to { transform: rotate(360deg); } }
@keyframes al-pop {
  from { opacity: 0; transform: translateY(10px) scale(.98); }
  to   { opacity: 1; transform: translateY(0)    scale(1); }
}
/* Section 區：關閉文字選取、iOS 長按呼叫菜單、點擊高亮 */
#section-container {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}
#section-container .section {
  -webkit-tap-highlight-color: transparent;
  will-change: transform;
  transition: transform 120ms ease;
}

/* 點擊/按壓的視覺回饋 */
.section.__pressed { transform: scale(0.985); }
@keyframes __bump {
  0% { transform: scale(1); }
  50%{ transform: scale(0.985); }
  100%{ transform: scale(1); }
}
.section.__bump { animation: __bump .18s ease; }

#section-container { touch-action: pan-y; }

/* 把檔案裡所有其他 .fab 刪掉，只留這段，並放在 <style> 的最底部 */
.fab{
  position: fixed; bottom: 24px; right: 24px;
  width: 48px; height: 48px; border-radius: 50%;
  display:flex; align-items:center; justify-content:center;
  background: rgba(0,170,255,0.85) !important; /* 半透明、偏淡藍 */
  color:#fff; font-size:28px; font-weight:700;
  box-shadow: 0 10px 22px rgba(0,0,0,.18);
  cursor:pointer; z-index: 110;
  transition: transform .2s ease, box-shadow .2s ease, opacity .2s ease, background-color .2s ease;
}
.fab:hover{ background: rgba(0,170,255,0.95) !important; }
.fab:active{ transform: scale(.98); }
.fab.open{ transform: rotate(45deg); }

/* 讓進度條與其文字蓋在最上層，避免被任務標題/天數遮住 */
.task{
  position: relative;
  overflow: hidden;
  /* 新增：避免與原生垂直捲動打架 */
  touch-action: pan-y;
}

.task .task-content, .task .task-days { position: relative; z-index: 2; }

.task .swipe-bar {
  position: absolute; top: 0; bottom: 0;
  width: 0%;
  z-index: 4;            /* ← 提到最上層 */
  display: flex; align-items: center;
  pointer-events: none;  /* 不攔互動 */
  overflow: hidden;
  transition: width .18s ease;
}

/* 進度條上的文字也確保在上層 */
.task .swipe-bar .label{
  position: relative;
  z-index: 5;            /* ← 保險，再高一層 */
  white-space: nowrap;
  opacity: 0;
  transition: opacity .12s ease, transform .12s ease;
  font-weight: 800; letter-spacing: .3px;
  font-size: .98rem;
}

/* 顏色與左右配置（更淺版本） */
.task .swipe-bar.right { 
  left: 0;  
  background: #d6fae8; /* 非常淡的綠色 */
  color: #0e4a36; 
}
.task .swipe-bar.right .label{ margin-left:12px; transform: translateX(-6px); }
.task .swipe-bar.left {  
  right: 0; 
  background: #ffe4e6; /* 非常淡的紅色 */
  color: #5c2020; 
  justify-content: flex-end; 
}
.task .swipe-bar.left  .label{ margin-right:12px; transform: translateX(6px); }

/* 取消手機點按高亮 & 焦點外框 */
.task { -webkit-tap-highlight-color: transparent; }
.task:focus, .task:focus-visible { outline: none; }

/* 動畫期間讓 GPU 合成更穩，避免邊緣「虛線」 */
.task.swiping { will-change: transform; }
.task { backface-visibility: hidden; transform: translateZ(0); }

/* 進度條也開合成，邊緣更穩定 */
.task .swipe-bar { will-change: width; transform: translateZ(0); }

/* 有圓角時讓塗色緊貼內側，降低邊緣鋸齒 */
.task { background-clip: padding-box; }

/* 今日日期：右上角輕量文字式 */
#today-badge{
  position: fixed;
  top: 14px;
  right: 12px;
  z-index: 120;
  padding: 4px 8px;
  border-radius: 6px;
  background: rgba(255, 255, 255, 0.4);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  color: rgba(50, 50, 50, 0.85);
  font-size: 14px;
  font-weight: 500;
  letter-spacing: 0.3px;
  user-select: none;
  pointer-events: none;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
/* 二選一即可（先試 A，不夠再用 B） */

/* A. 極小位移 */
#today-badge{ transform: translateX(0.5px); }

/* B. 非對稱 padding（右邊多 1px） */
#today-badge{ padding-left: 9px; padding-right: 0px; }

/* ===== 拉絲金屬（無斷層版）===== */
/* 無縫、穩定、不吃 DPI 的金屬底 */
/* 平滑霧面金屬效果（無格線感） */
body.bg-metal::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;

  /* 柔光高亮 + 垂直刷絲紋路（超細微） */
  background-image:
    linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.12)),
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,0.03) 0px,
      rgba(255,255,255,0.03) 1px,
      rgba(0,0,0,0.02) 1px,
      rgba(0,0,0,0.02) 2px
    );

  background-blend-mode: screen, normal;

  /* 讓紋理極度細緻，避免網格感 */
  background-size: 100% 100%, 600px 100%;
  background-repeat: no-repeat, repeat;

  /* 輕微對比與飽和度，保留金屬感 */
  filter: contrast(103%) saturate(97%);
}


/* 展開圖示 */
.expand-icon{
  display:inline-flex; align-items:center; justify-content:center;
  width:22px; height:22px; margin-left:.4rem;
  border-radius:4px; border:1px solid #ddd; background:#f8f8f8;
  cursor:pointer; font-size:12px; line-height:1; color:#555;
  transform: translateY(4px);            /* ⬅ 往下移一點 */
}
.expand-icon:active{ transform: scale(.97); }

/* 大型閱讀面板 */
#detailViewer{
  display:none;
}
#detailViewer.show{
  display:block;
}
#detailForm.hide{
  display:none;
}
.viewer-head{
  display:flex; align-items:center; justify-content:space-between;
  gap:.5rem; margin-bottom:.5rem;
}
.viewer-title{
  font-weight:700; font-size:1rem;
}
.viewer-close{
  border:1px solid #ddd; background:#f7f7f7; border-radius:6px;
  padding:.35rem .6rem; cursor:pointer;
}
.viewer-body{
  width:100%;
  min-height:50vh;
  padding:.75rem;
  border:1px solid #eee;
  border-radius:8px;
  background:#fafafa;
  line-height:1.6;
  font-size:.95rem;
  resize:vertical; /* 可以調整高度 */
}
/* 強制調色盤按鈕為小淺底樣式 */
button.palette-btn {
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
  padding: 4px 8px !important;
  font-size: 0.85rem !important;
  font-weight: normal;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: #f9f9f9 !important;
  color: #333 !important;
  width: auto !important;
  min-width: unset !important;
  margin-top: -3rem; /* 與「更換底色」的距離 */
}
button.palette-btn:hover {
  background: #f1f1f1 !important;
}
button.palette-btn:active {
  background: #e8e8e8 !important;
}

/* 調色盤九宮格 */
.palette-grid{
  display:grid; grid-template-columns: repeat(3, 1fr);
  gap:.75rem;
}
.palette-choice{
  position:relative;
  width:100%; aspect-ratio:1/1; border-radius:12px; border:1px solid #e5e5e5;
  box-shadow: 0 1px 2px rgba(0,0,0,.06); cursor:pointer; overflow:hidden;
}
.palette-choice[data-color="#f6fbfe"]{ background:#f6fbfe; }
.palette-choice[data-color="#f3fcf8"]{ background:#f3fcf8; }
.palette-choice[data-color="#fffcf3"]{ background:#fffcf3; }
.palette-choice[data-color="#fef6f9"]{ background:#fef6f9; }
.palette-choice[data-color="#f9f8fd"]{ background:#f9f8fd; }
.palette-choice[data-color="#ffeded"]{ background:#ffeded; }
.palette-choice[data-color="#fff8f5"]{ background:#fff8f5; }
.palette-choice[data-color="#fdfcf9"]{ background:#fdfcf9; }
/* 金屬特效（看起來像金屬） */
.palette-choice[data-color="metal"]{ background: #e5e5e5; }
.palette-choice .metal-sheen{
  position:absolute; inset:0;
  background:
    linear-gradient(135deg, rgba(255,255,255,.35), rgba(255,255,255,.1)),
    repeating-linear-gradient(90deg, rgba(255,255,255,.08) 0 1px, rgba(0,0,0,.04) 1px 2px);
  mix-blend-mode: screen; pointer-events:none;
}

/* 選取狀態 */
.palette-choice.selected{
  outline: 3px solid #176dff;
  box-shadow: 0 0 0 3px rgba(23,109,255,.15) inset;
}
.filter-status .important-only{
  display:inline-flex; align-items:center; gap:.25rem;
  margin-left:.25rem; user-select:none; cursor:pointer;
}

/* 展開層工具列：小巧、不佔空間，但好按 */
.viewer-toolbar{
  display:flex;
  gap:.4rem;
  margin: .1rem 0 .4rem;
}

.vt-btn{
  border:1px solid #ddd;
  background:#f8f8f8;
  border-radius:6px;
  padding:.3rem .5rem;
  font-size:1rem;
  line-height:1;
  cursor:pointer;
  transition: background .15s ease, transform .02s ease, opacity .2s ease;
}
.vt-btn:hover{ background:#f1f1f1; }
.vt-btn:active{ transform: translateY(1px); }
.vt-btn[disabled]{ opacity:.45; cursor:not-allowed; }

/* 編輯分類時，任務卡不可互動/不可滑動 */
.section.edit-mode .task,
.section.edit-mode .task * {
  pointer-events: none !important;
}
/* 順便把滑動指示條藏起來，避免視覺干擾 */
.section.edit-mode .task .swipe-bar {
  display: none !important;
}
/* ===== Recurrence picker (inline + modal) ===== */
.rec-mode-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;margin-top:.5rem}
.rec-bigbtn{padding:.6rem .8rem;border:1px solid #ddd;border-radius:8px;background:#f7fbff;cursor:pointer;font-weight:700}
.rec-bigbtn:hover{background:#eef6ff}
.rec-chiprow{display:flex;flex-wrap:wrap;gap:.5rem;margin:.5rem 0}
.rec-chip{min-width:35px;padding:.45rem .6rem;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;text-align:center}
.rec-chip.selected{background:#176dff22;border-color:#176dff}
.rec-footer{display:flex;gap:.75rem;margin-top:1rem}
.rec-footer button{flex:1;padding:.6rem;border:none;border-radius:8px;cursor:pointer}
.btn-light{background:#f2f2f2}
.btn-primary{background:#176dff;color:#fff}
.rec-cal-head{display:flex;align-items:center;justify-content:space-between;margin:.25rem 0 .5rem}
.rec-nav{display:flex;gap:.4rem}
.rec-nav button{padding:.25rem .5rem;border:1px solid #ddd;border-radius:6px;background:#fff;cursor:pointer}
.rec-cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:.35rem}
.rec-dayname{font-size:.8rem;color:#666;text-align:center}
.rec-date{aspect-ratio:1/1;border:1px solid #eee;border-radius:8px;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer}
.rec-date.selected{outline:3px solid #176dff55;border-color:#176dff}

/* === 日期徽章 → 可點按鈕 + 日曆有任務紅字 === */
#today-badge{
  pointer-events: auto;   /* 原本是 none，改成可點 */
  cursor: pointer;
}
#today-badge:active{ transform: translateY(1px); }

/* 月曆中，當天若有任務（有預定完成日）→ 紅字 */
.rec-date.has-task{
  color: #d33;
  font-weight: 700;
}
/* ===== 搜尋欄（放在 moreModal 裡） ===== */
#moreModal .modal-content { position: relative; }
.search-wrap{
  max-width: 200px;
  margin: 0 auto .25rem;
  display:flex; align-items:center; gap:.5rem;
  margin:0 0 .25rem 0; padding:10px 12px;
  border-radius:12px;
  background: rgba(255,255,255,.86);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  border:1px solid rgba(180,210,255,.35);
  box-shadow: 0 8px 20px rgba(0,60,130,.08);
}
.search-ico{ font-size:1rem; opacity:.7; transform:translateY(1px); pointer-events:none; }
#taskSearchInput{
  flex:1; height:24px; border:0; outline:none; background:transparent; font-size:12px;
}
#taskSearchInput::placeholder{ color:#9aa7bd; }
.search-clear{
  border:0; background:#eef3ff; color:#4a6aa8;
  width:20px; height:20px; font-size:12px;border-radius:50%;
  cursor:pointer; font-weight:700; line-height:1;
  display:inline-flex; align-items:center; justify-content:center;
  box-shadow:0 1px 2px rgba(0,0,0,.06);
}
.search-clear:active{ transform:translateY(1px); }

/* 搜尋隱藏（不影響其它篩選，能疊加） */
.task.search-hide{ display:none !important; }
/* === Login page legal links === */
/* 置底的政策連結（不擋畫面） */
/* 置底，左右分佈的政策連結 */
/* 置底，置中排列，兩個連結左右分開 */
/* 連絡我們/政策列：手機也固定橫向排列 */
.legal-links{
  position: fixed;
  left: 50%;
  bottom: max(16px, env(safe-area-inset-bottom));
  transform: translateX(-50%);
  display: flex;
  flex-wrap: nowrap;               /* ⬅ 不允許換行 */
  gap: 10px;
  justify-content: center;
  align-items: center;
  z-index: 150;

  /* 窄螢幕時可水平滑動，不會擠壓跑版 */
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  padding: 0 8px;
  max-width: 100vw;                /* 避免超出螢幕 */
}

.legal-links a{
  flex: 0 0 auto;                  /* ⬅ 固定橫向一顆接一顆 */
  color: #176dff;
  text-decoration: none;
  background: #eef6ff;
  border: 1px solid #d6eaff;
  padding: 8px 12px;
  border-radius: 8px;
  box-shadow: 0 1px 2px rgba(0,0,0,.06);
  min-width: 100px;                /* 保持可點的按鈕寬 */
  text-align: center;
  font-size: 14px;
  font-weight: 700;
}

/* 可選：隱藏水平捲軸（保留可滑動） */
.legal-links::-webkit-scrollbar{ display:none; }

.legal-links a:hover{ background:#e6f1ff; }
.legal-links a:active{ transform: translateY(1px); }

/* 超小螢幕時（≤360px），每個按鈕吃滿行寬，避免擠壓 */
@media (max-width: 360px){
  .legal-links{
    gap: 8px;
    width: calc(100% - 24px);  /* 邊緣保留些許空白 */
  }
  .legal-links a{
    min-width: unset;
    width: 100%;
  }
}

/* 更多視窗中的「連絡我們」輕量樣式 */
.more-contact{
  margin-top: .25rem;
  text-align: center;
  font-size: .92rem;
}
.more-contact a{
  color:#176dff;
  text-decoration:none;
}
.more-contact a:hover{ text-decoration: underline; }





  </style>
</head>
<body>
<!-- 登錄頁面 -->
<div id="loginPage">
  <div id="loginCard">
   <h1 style="display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 24px;">
  <img src="https://cdn.jsdelivr.net/gh/a355226/kj-reminder/reminder.png" alt="icon" width="40" style="position: relative; top: 1px;">
  MyTask
</h1>

    <label class="login-label">自訂帳號</label>
    <input type="text" id="login-username" class="login-input" placeholder="請輸入帳號">

    <label class="login-label">自訂密碼</label>
    <input type="password" id="login-password" class="login-input" placeholder="請輸入密碼">

    <label class="login-checkrow">
      <input type="checkbox" id="auto-login">
      <span>自動登入</span>
    </label>

    <button id="login-btn" class="login-btn">登入</button>

    <p class="login-tip">平台免註冊，自訂帳號密碼即可登錄</p>
  </div>

  <!-- ▼ 新增：登入頁面下方的政策連結（清楚、可點） -->
  <div class="legal-links" role="contentinfo" aria-label="政策連結">
    <a href="https://kjapps.com/privacy.html"
       target="_blank" rel="noopener noreferrer"
       aria-label="開啟隱私權政策（新分頁）">隱私權政策</a>
    <a href="https://kjapps.com/terms.html"
       target="_blank" rel="noopener noreferrer"
       aria-label="開啟服務條款（新分頁）">服務條款</a>
         <!-- ✅ 新增：連絡我們（mailto） -->
         <a href="https://kjapps.com/aboutus.html"
         target="_blank" rel="noopener noreferrer"
         aria-label="開啟隱私權政策（新分頁）">聯絡我們</a>
  </div>
  <!-- ▲ 新增結束 -->
</div>




<div class="container" style="display:flex; justify-content:center;">

<div style="text-align:center">
  <h1 class="app-title">
    <a href="mymemo.html" class="title-link">
      <img src="https://cdn.jsdelivr.net/gh/a355226/kj-reminder/reminder.png"
           alt="icon" width="40">
      <span>MyTask</span>
    </a>
  </h1>
</div>

<style>
  /* 只保留 h1 的字級/間距，關掉外層 hover/陰影/圓角 */
  h1.app-title{
    font-size:24px;
    margin:6px 0 10px;
    padding:0;                 /* ← 取消外層內距 */
    border-radius:0;           /* ← 取消外層圓角 */
    background:transparent;
    box-shadow:none;
  }
  h1.app-title:hover{          /* ← 擋掉全域 h1:hover */
    background:transparent !important;
    box-shadow:none !important;
  }

  /* 膠囊只套在 a，上下感完全一體 */
  .title-link{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding:4px 10px;
    border-radius:8px;
    text-decoration:none;
    color:inherit;
    cursor:pointer;
    line-height:1;
    -webkit-tap-highlight-color: transparent; /* iOS 點擊別再出灰色塊 */
  }
  .title-link:hover{
    background:rgba(0,0,0,.05);
    box-shadow:0 0 0 2px rgba(0,0,0,.08) inset;
  }
  .title-link:active{ transform: translateY(1px); }
  .title-link:focus-visible{ outline:2px solid #176dff; outline-offset:2px; }

  .title-link img{ display:block; transform: translateY(2px); }
</style>




<div id="today-badge" aria-label="今天日期"></div>
<!-- 右上角 ... 按鈕 -->
<div class="more-btn" onclick="openModalById('moreModal')">⋯</div>
<div id="section-container">
<div id="doneMore" style="display:none; text-align:right; margin:0.25rem 0;">
  <button id="doneMoreBtn" style="border:0; background:#eee; padding:6px 10px; border-radius:8px; cursor:pointer;">更多…</button>
  <div id="doneMonthMenu" style="display:none; position:absolute; right:16px; background:#fff; border:1px solid #ddd; border-radius:8px; box-shadow:0 4px 10px rgba(0,0,0,.08); padding:6px; z-index:50;"></div>
</div>

  </div>

  <div class="fab" onclick="toggleMenu()">＋</div>
<div class="menu" id="menu">
<button onclick="openModal()" 
        style="background:#e6f6fc; color:#0091cc; font-weight:600; 
               padding:8px 16px; border:none; border-radius:8px; 
               box-shadow:0 2px 4px rgba(0,0,0,.08); cursor:pointer; 
               margin-bottom:12px;">
  新增任務
</button>

<button onclick="openCategoryModal()" 
        style="background:#e9f9f1; color:#1fa87a; font-weight:600; 
               padding:8px 16px; border:none; border-radius:8px; 
               box-shadow:0 2px 4px rgba(0,0,0,.08); cursor:pointer; 
               margin-bottom:12px;">
  新增分類
</button>

<button onclick="enterEditMode()" 
        style="background:#fff6e6; color:#d98a00; font-weight:600; 
               padding:8px 16px; border:none; border-radius:8px; 
               box-shadow:0 2px 4px rgba(0,0,0,.08); cursor:pointer;">
  編輯分類
</button>
</div>

<!-- ✅ 新增的按鈕，讓使用者完成編輯分類 -->
<button id="exitEditBtn" onclick="exitEditMode()" style="
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #e3ffe8;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 6px 14px;
  font-size: 13px;
  font-weight: bold;
  cursor: pointer;
  z-index: 10;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
">✅</button>


<!-- 新增任務視窗 -->
<div class="modal" id="taskModal">
  <div class="modal-content">
    <button class="close-btn" onclick="closeModal('taskModal')">✕</button>
    <h3>新增任務</h3>
  <label>任務分類</label>
  <div class="inline-row">
    <!-- 這裡要用 taskSection（不是 detailSection）-->
    <select id="taskSection" class="half">
    </select>

    <!-- 這裡要用 taskImportant（不是 detailImportant）-->
    <label class="important-flag">
      <input type="checkbox" id="taskImportant">
      重要
    </label>
  </div>

      <label>任務標題(必填)</label>
      <input type="text" id="taskTitle">
      <label>任務內容</label>
      <textarea id="taskContent"></textarea>
      <label>預定完成日</label>
      <input type="date" id="taskDate">
      <label>處理情形</label>
      <textarea id="taskNote"></textarea>
      <button onclick="addTask()" style="font-weight:bold;">新增</button>
    </div>
  </div>

  <!-- 任務內容檢視視窗 -->
  <div class="modal" id="detailModal">
    <div class="modal-content">
      <button class="close-btn" onclick="closeModal('detailModal')">✕</button>
    <h3 style="display:flex;align-items:center;gap:.5rem;">
  <span>任務資訊</span>
  <small id="detailLastUpdate" style="font-size:.9rem;color:#666;white-space:nowrap;margin-left:.5rem;"></small>
</h3>



<!-- ▼ 表單視圖：預設顯示 -->
<div id="detailForm">
  <label>任務分類</label>
  <div class="inline-row">
    <select id="detailSection" class="half"></select>
    <label class="important-flag">
      <input type="checkbox" id="detailImportant"> 重要
    </label>
  </div>

  <label>任務標題</label>
  <input type="text" id="detailTitle">

  <!-- 任務內容：加展開鈕 -->
  <div class="label-row" style="display:flex;align-items:center;">
    <label for="detailContent">任務內容</label>
    <button type="button"
            class="expand-icon"
            onclick="toggleDetailExpand('detailContent','任務內容')"
            title="展開" aria-label="展開任務內容">⤢</button>
  </div>
  <textarea id="detailContent"></textarea>
  

  <label>預定完成日</label>
  <input type="date" id="detailDate">

  <!-- 處理情形：加展開鈕 -->
  <div class="label-row" style="display:flex;align-items:center;">
    <label for="detailNote">處理情形</label>
    <button type="button"
            class="expand-icon"
            onclick="toggleDetailExpand('detailNote','處理情形')"
            title="展開" aria-label="展開處理情形">⤢</button>
  </div>
  <textarea id="detailNote"></textarea>
  

  <div style="display: flex; gap: 0.5rem;">
    <button class="save-btn-half" onclick="saveTask()">💾 儲存</button>
    <button class="delete-btn-half" onclick="confirmDelete()">🗑️ 移除</button>
  </div>

  <!-- 滑動完成 -->
  <div class="slide-complete" id="slideComplete">
    <div class="slide-track">
      <div class="slide-hint">➡ 往右拖拉完成</div>
      <div class="slide-fill" id="slideFill"></div>
      <div class="slide-handle" id="slideHandle" aria-label="往右拖拉完成"></div>
    </div>
  </div>
</div>
<!-- ▲ 表單視圖 -->

<!-- ▼ 閱讀視圖：展開後顯示（預設隱藏） -->
<div id="detailViewer">
  <div class="viewer-head">
    <div class="viewer-title" id="viewerTitle"></div>
    <button type="button" class="viewer-close" onclick="toggleDetailExpand()">⤢</button>
  </div>
    <!-- ✅ 新增：展開層三鍵工具列 -->
  <div class="viewer-toolbar">
    <button class="vt-btn" title="還原" onclick="viewerUndo()">⤺</button>
    <button class="vt-btn" title="復原" onclick="viewerRedo()">⤻</button>
    <button class="vt-btn" title="複製" onclick="viewerCopy()">⧉
</button>
  </div>
  <textarea class="viewer-body" id="viewerBody"></textarea>

</div>
<!-- ▲ 閱讀視圖 -->


    </div>
  </div>

  <script src="./app.js" defer></script>

 


<div id="check-success">
  <svg viewBox="0 0 52 52">
    <!-- 新增的白底 -->
    <circle cx="26" cy="26" r="25" fill="#fff"/>
    <!-- 原本的動畫圈與勾勾 -->
    <circle class="circle" cx="26" cy="26" r="18" fill="none"/>
    <path class="check" fill="none" d="M14 27l7 7 16-16"/>
  </svg>
</div>


<div class="modal" id="confirmModal">
  <div class="modal-content">
    <h3 style="text-align: center;">是否確認移除此任務？</h3>
    <div class="confirm-buttons">
      <button class="confirm-btn" onclick="deleteTask()">確認</button>
      <button class="cancel-btn" onclick="closeModal('confirmModal')">返回</button>
    </div>
  </div>
</div>

<!-- ✅ 登出確認 modal 要和上面同一層，千萬不要放在 confirmModal 裡 -->
<div class="modal" id="logoutModal">
  <div class="modal-content">
    <h3 style="text-align:center;">是否確認登出？</h3>
    <div class="confirm-buttons">
      <button class="confirm-btn" onclick="doLogout()">確認</button>
      <button class="cancel-btn" onclick="closeModal('logoutModal')">取消</button>
    </div>
  </div>
</div>

<div class="modal" id="categoryModal">
  <div class="modal-content">
<h3 style="text-align: center;">新增分類</h3>
<input type="text" id="newCategoryName" placeholder="請輸入分類名稱">
    <div class="confirm-buttons">
      <button class="confirm-btn" onclick="addCategory()">確認</button>
      <button class="cancel-btn" onclick="closeModal('categoryModal')">取消</button>
    </div>
  </div>
</div>
<!-- 重命名分類 Modal -->
<div class="modal" id="renameModal">
  <div class="modal-content">
    <button class="close-btn" onclick="closeModal('renameModal')">✕</button>
    <h3 style="text-align:center;">重新命名分類</h3>
    <input type="text" id="renameInput" placeholder="請輸入新的分類名稱" />
    <div class="confirm-buttons">
      <button class="confirm-btn" onclick="confirmRename()">確認</button>
      <button class="cancel-btn" onclick="closeModal('renameModal')">取消</button>
    </div>
  </div>
</div>




<!-- 更多功能 Modal -->
<div class="modal" id="moreModal">
  <div class="modal-content">
    <button class="close-btn" onclick="closeModal('moreModal')">✕</button>
    <!-- 🔎 搜尋欄（只保留右側 X） -->
<div id="globalSearch" class="search-wrap modal-search" role="search" aria-label="搜尋任務">
  <span class="search-ico" aria-hidden="true">🔍</span>
  <input id="taskSearchInput" type="text" autocomplete="off"
         placeholder="在MyTask中搜尋" aria-label="搜尋標題、任務內容、處理情形">
  <button id="taskSearchClear" class="search-clear" aria-label="清除搜尋">✕</button>
</div>

    <h3>篩選剩餘天數</h3>
<div class="filter-days">
  <label><input type="radio" name="daysFilter" value="1"> 1</label>
  <label><input type="radio" name="daysFilter" value="3"> 3</label>
  <label><input type="radio" name="daysFilter" value="5"> 5</label>
  <label><input type="radio" name="daysFilter" value="all"> 無</label>
  <label><input type="radio" name="daysFilter" value="default" checked> 預設</label>
</div>
<h3>任務狀態</h3>
<div class="filter-status">
  <label><input type="radio" name="statusFilter" value="ongoing" checked> 進行中</label>
  <label><input type="radio" name="statusFilter" value="done"> 已完成</label>
  <!-- ✅ 新增：重要開關（最後一層篩選） -->
  <label class="important-only" title="只看❗重要">
    <input type="checkbox" id="importantOnly"> ❗
  </label>
</div>
<h3>天數設定</h3>
<div class="filter-mode">
  <label><input type="radio" name="dayMode" value="work" checked> 工作天</label>
  <label><input type="radio" name="dayMode" value="calendar"> 日曆天</label>
</div>
<h3>更換底色</h3>
<button id="openPaletteBtn" class="palette-btn">🎨 調色盤</button>
<hr style="margin:1rem 0;border:none;border-top:1px solid #eee;">
<button class="logout-btn" style="font-weight:bold;" onclick="openLogoutModal()">登出</button>

  </div>
</div>

<!-- 自動登入載入中 -->
<div id="autologin-overlay" aria-hidden="true">
  <div class="autologin-box">
    <div class="autologin-loader"></div>
    <div class="autologin-text">自動登入中…</div>
  </div>
</div>
<div class="modal" id="welcomeModal">
  <div class="modal-content" style="text-align:left; line-height:1.6;">
    <h3 style="text-align:center;">👋 歡迎使用 MyTask</h3>
    <ol style="padding-left:1.2rem; margin-top:0.8rem;">
      <li>右下「＋」新增任務或分類</li>
      <li>長按分類空白處，可快速新增</li>
      <li>點「任務」可查看/編輯內容</li>
      <li>右滑「任務」快速完成/左滑移除</li>
      <li>左上「⋯」可切換篩選條件等功能</li>
      <li style="font-weight:bold; color:#ff462e;">點擊「MyTask」切換「備忘模式」</li>
<li style="font-weight:bold; color:#007BFF;">新增第一個「分類」開始使用！</li>
    </ol>
    <button class="confirm-btn" style="margin-top:1rem; width:100%;" onclick="closeModal('welcomeModal')">我知道了</button>
  </div>
</div>

<!-- 調色盤 Modal -->
<div class="modal" id="paletteModal">
  <div class="modal-content">
    <button class="close-btn" onclick="closeModal('paletteModal')">✕</button>
    <h3 style="text-align:center;">選擇底色</h3>

    <div class="palette-grid" id="paletteGrid" style="margin-top:.5rem;">
      <!-- 每個色塊用 data-color 標記 -->
      <button class="palette-choice" data-color="#f6fbfe" title="預設"></button>
      <button class="palette-choice" data-color="#f3fcf8" title="淺綠"></button>
      <button class="palette-choice" data-color="#fffcf3" title="淺黃"></button>
      <button class="palette-choice" data-color="#fef6f9" title="淺粉"></button>
      <button class="palette-choice" data-color="#f9f8fd" title="淡紫"></button>
      <button class="palette-choice" data-color="#ffeded" title="淺棕"></button>
      <button class="palette-choice" data-color="#fff8f5" title="淺橘"></button>
      <button class="palette-choice" data-color="#fdfcf9" title="米白"></button>
      <button class="palette-choice" data-color="metal"  title="鐵灰（金屬）">
        <span class="metal-sheen"></span>
      </button>
    </div>

    <div class="confirm-buttons" style="margin-top:1rem;">
      <button class="confirm-btn" id="paletteConfirmBtn">確認</button>
      <button class="cancel-btn" onclick="closeModal('paletteModal')">取消</button>
    </div>
  </div>
</div>

<!-- 日期篩選：月曆 Modal -->
<div class="modal" id="dateFilterModal">
  <div class="modal-content">
    <button class="close-btn" onclick="closeModal('dateFilterModal')">✕</button>
    <h3 style="text-align:center;">選擇日期</h3>

    <div class="rec-cal-head">
      <div class="rec-nav">
        <button id="dfPrev">&lt;</button>
        <button id="dfToday">今</button>
        <button id="dfNext">&gt;</button>
      </div>
      <div id="dfYM"></div>
    </div>

    <div class="rec-cal-grid" id="dfCalNames"></div>
    <div class="rec-cal-grid" id="dfCalGrid"></div>

    <div class="confirm-buttons" style="margin-top:1rem;">
      <button class="confirm-btn" id="dfClearBtn">顯示全部</button>
      <button class="cancel-btn" onclick="closeModal('dateFilterModal')">關閉</button>
    </div>
  </div>
</div>


</body>
</html>
